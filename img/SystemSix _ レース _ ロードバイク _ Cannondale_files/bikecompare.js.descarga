!function(){const e=document.querySelector(".compare-tool");if(!e)return;function t(){return window.innerWidth<window.cannondaleBreakpoints.largeTablet}const a=e.querySelector(".compare-panel-header"),i=e.querySelector(".compare-panel"),s=e.querySelector('.show-trigger[data-trigger="compare-panel-header"]'),n=e.querySelector("[data-trigger='compare-panel']"),o=a.querySelector(".content-container"),r=i.querySelector(".chosen-bikes.product-grid"),l=i.querySelector(".product-grid.mobile-only"),c=document.querySelector("main"),d=new LoadingGraphic(a,{position:"absolute",background:"rgba(255,255,255,0.4)"}),p=new RegExp(`^en-(${["BR","ES","FR","IT","JP","LA"].join("|")})$`),m=/[.,]00\b/i;let u=document.querySelector("html").getAttribute("lang");window.EndpointManager.registerParameterizedEndpoint("bike-compare",(e=>`/${u.toLowerCase()}/api/products/${e.join()}`)),p.test(u)?u+="-english":/^es-LA$/.test(u)&&(u+="-spanish");let g={BikeCompareDtos:[],LanguageRegion:u,Skus:[]};function h(e){return e&&"string"==typeof e?e.replace(/\bnull\b/gi,""):""}function v(){document.querySelectorAll("a.compare").forEach((e=>{-1===g.Skus.indexOf(e.getAttribute("data-salsifyid"))?(e.removeAttribute("data-added"),e.textContent="+Compare"):(e.setAttribute("data-added","added"),e.textContent="-Remove")}))}async function y(a){if(d.start(),a)try{const e=await window.EndpointManager.getParameterizedEndpoint("bike-compare",g.Skus);e&&e.length&&(e.forEach((e=>{e.Price||(e.Variants[0].SalePrice>0?e.Price=e.Variants[0].SalePriceFormatted.replace(m,""):e.Variants[0].MsrpFormatted&&(e.Price=e.Variants[0].MsrpFormatted.replace(m,"")))})),g.BikeCompareDtos=e,localStorage.setItem(`skuList_${window.RegionSetting}`,g.Skus),localStorage.setItem(`BikeCompareDtos_${window.RegionSetting}`,JSON.stringify(g.BikeCompareDtos)))}catch(e){console.log("error retrieving bike compare details",e)}else{const e=localStorage.getItem(`skuList_${window.RegionSetting}`);g.Skus=e&&e.length?e.split(","):[];const t=localStorage.getItem(`BikeCompareDtos_${window.RegionSetting}`),a=t?JSON.parse(t):[];g.BikeCompareDtos=a}!function(){const e=g.BikeCompareDtos.map(k);3===e.length&&e.pop(),l.innerHTML=e.join(""),r.innerHTML=g.BikeCompareDtos.map(L).join("")}(),function(){document.querySelectorAll(".specifications-section .specs").forEach((e=>e.remove())),document.querySelectorAll(".specifications-section .specs-trigger").forEach((e=>e.classList.add("hidden")));const e=Array.from(document.querySelectorAll(".specifications-section")),t=[{className:"highlights",key:"Highlights"},{className:"where-it-thrives",key:"WhereItThrives"},{className:"what-built-for",key:"WhatBuiltFor"}];t.forEach((e=>{e.elem=document.querySelector(`.info-grid.${e.className}`),e.headlineElem=e.elem.previousElementSibling,e.elem.innerHTML=""})),g.BikeCompareDtos.length&&(g.BikeCompareDtos.forEach((a=>{t.forEach((e=>{e.details=h(a[e.key]);const t=document.createElement("div");t.className="info-card card",e.details&&e.details.length||(t.className+=" empty-specs"),t.innerHTML=`\n              <ul class="plain">\n                <li>${e.details}</li>\n              </ul>`,e.elem.appendChild(t)})),e.forEach((e=>{const t=e.getAttribute("data-spec-name");if(t&&t.length){const i=t.split("."),s=e.getAttribute("data-spec-detail"),n=s&&s.length?s.split("."):null,o=h($(a,i)),r=n?h($(a,n)):"";o.length?(e.appendChild(b(o,r,t)),r.length&&e.querySelector(".specs-trigger").classList.remove("hidden")):e.appendChild(b("","",t))}}))})),t.forEach((e=>{0===e.elem.querySelectorAll(".info-card:not(.empty-specs)").length?(e.elem.style.display="none",e.headlineElem.style.display="none"):(e.elem.style.removeProperty("display"),e.headlineElem.style.removeProperty("display"))})),e.forEach((e=>{0===e.querySelectorAll(".specs:not(.empty-specs)").length?e.style.display="none":e.style.removeProperty("display")})),document.querySelectorAll(".specifications-section-group").forEach((e=>{0===e.querySelectorAll(".specs:not(.empty-specs)").length?e.classList.add("hidden"):e.classList.remove("hidden")})))}(),t()||(o.innerHTML=g.BikeCompareDtos.map(w).join("")),g.Skus.length?(e.classList.remove("hidden"),document.body.classList.add("compare-toolbar-active")):(e.classList.add("hidden"),document.body.classList.remove("compare-toolbar-active"),e.classList.contains("is-takeover")&&n.click()),v();const i=new Event("bikeComparePopulate");document.dispatchEvent(i),d.end()}function f(i){if(d.running)return!1;if(i.hasAttribute("data-added"))S(i.getAttribute("data-salsifyid")),i.removeAttribute("data-added"),i.textContent="+Compare";else{const n=i.getAttribute("data-salsifyid");e.classList.remove("hidden"),g.Skus.length<(t()?2:3)&&-1===g.Skus.indexOf(n)&&(g.Skus.push(n),localStorage.setItem("skuList",g.Skus),i.setAttribute("data-added","added"),i.textContent="-Remove",y(!0),t()||a.classList.contains("is-open")||s.click())}}function S(e){const t=localStorage.getItem(`skuList_${window.RegionSetting}`),a=t?t.split(","):[],i=localStorage.getItem(`BikeCompareDtos_${window.RegionSetting}`),s=(i?JSON.parse(i):[]).filter((t=>t.SalsifyId!==e));a.splice(a.indexOf(e),1),localStorage.setItem(`skuList_${window.RegionSetting}`,a.join()),localStorage.setItem(`BikeCompareDtos_${window.RegionSetting}`,JSON.stringify(s)),document.querySelectorAll(`a.compare[data-salsifyid="${e}"]`).forEach((e=>{e.removeAttribute("data-added"),e.textContent="+Compare"})),y(!1)}function k(e){return`\n      <div class="mobile-compare-card">\n        <div class="text">\n          <h2 class="title">\n            <strong class="platform">${e.Title}</strong>\n            <span class="name">${e.Subtitle}</span>\n          </h2>\n          ${e.Price?`<span class="price">${e.Price}</span>`:""}\n        </div>\n        <div class="actions">\n          <a class="small inverted secondary button" href="${e.RelativeUrl}">View Details</a>\n          <div class="remove">\n            <a class="compare remove" data-added="added" data-salsifyid="${e.SalsifyId}">Remove</a>\n          </div>\n        </div>\n        <div class="look">\n          <div class="content">\n            <div class="image"><img src="${e.ProductImageUrl}" alt=""></div>\n            <span class="color" style="background:${e.BackgroundColor};"></span>\n          </div>\n        </div>\n      </div>`}function L(e){return`<div class="product-card card">\n    <div class="product-card__upper">\n      <div class="card-inner">\n        <a class="content product" data-color="dark" href="${e.RelativeUrl}">\n          <div class="tags"></div>\n          <img src="${e.ProductImageUrl}" alt="">\n          <div class="product-details">\n            <h2 class="title">${e.Title}</h2>\n            <div class="details">\n              <div class="detail">${e.Subtitle}</div>\n              ${e.Price?`<strong class="price">${e.Price}</strong>`:""}\n            </div>\n          </div>\n        </a>\n        <a data-salsifyid="${e.SalsifyId}" class="compare">+Compare</a>\n      </div>\n    </div>\n  </div>`}function $(e,t){for(;t.length;){if(!(e=e[t.shift()]))return null}return e}function b(e,t,a){let i=t.length?`\n        <ul class="inline more-specs plain" data-panel="specs-${a}">\n          ${t.split("|").map((e=>`<li>${e}</li>`)).join("")}\n        </ul>\n      `:"";const s=document.createElement("div");return s.className=e.length?"specs":"specs empty-specs",s.innerHTML=`\n      <ul class="plain"><li>${e}</li></ul>\n      ${i}\n    `,s}function w(e){return`\n      <div class="product" data-salsifyid="${e.SalsifyId}">\n        <img src="${e.ProductImageUrl}" alt="">\n        <h2 class="title"><strong class="platform">${e.Title}</strong>${e.Subtitle}</h2>\n        <a class="remove" data-salsifyid="${e.SalsifyId}">Remove</a>\n      </div>\n    `}s.addEventListener("click",(e=>{window.localStorage.setItem("hideComparePanelHeader",s.classList.contains("is-active"))}));"true"===window.localStorage.getItem("hideComparePanelHeader")&&s.click(),o.querySelectorAll(".product").length>0?e.classList.remove("hidden"):e.classList.add("hidden"),document.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("compare"))return e.preventDefault(),f(t),!1})),o.addEventListener("click",(e=>{const t=e.target;t.classList.contains("remove")&&S(t.getAttribute("data-salsifyid"))})),n.addEventListener("click",(i=>{e.classList.toggle("is-takeover"),e.classList.contains("is-takeover")?(c.style.zIndex=999,a.classList.contains("is-open")&&s.click()):(c.style.zIndex=0,t()||s.click())})),e.addEventListener("scroll",(e=>{a.classList.toggle("is-sticky",r.getBoundingClientRect().top<=-200)})),y(),document.addEventListener("productSearchResultsLoaded",((e,t)=>{v()})),window.bikeCompareTool={setCompareLinkStatuses:v}}();